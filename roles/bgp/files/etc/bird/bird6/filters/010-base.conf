function is_private() {
  return net ~ [
    ::ffff:0:0/96+,
    64:ff9b::/96+,
    64:ff9b:1::/48+,
    100::/64+,
    2001::/23+,
    2001::/32+,
    2001:2::/48+,
    2001:3::/32+,
    2001:4:112::/48+,
    2001:5::/32+,
    2001:10::/28+,
    2001:20::/28+,
    2001:db8::/32+,
    2002::/16+,
    2620:4f:8000::/48+,
    fc00::/7+,
    fe80::/10+
  ];  
}

function is_publicly_routable() {
  return net.len <= 48 && 
    !is_private();
}

function is_default() {
  return net ~ [ ::/0 ];
}

filter upstream_export {
  if is_default() then {
    reject "Default route not allowed in fulltable setup";
  }
  if ! is_publicly_routable() then {
    reject "Not publicly routable";
  }
  if ! is_own_net() then {
    reject "Not our network";
  }
  accept;
}

filter upstream_import {
  if is_default() then {
    reject "Default route not allowed in fulltable setup";
  }
  if ! is_publicly_routable() then {
    reject "Not publicly routable";
  }
  if is_own_net() then {
    reject "Part of our network";
  }
  accept;
}

filter ibgp_import {
  accept;
}

filter ibgp_export {
  accept;
}
