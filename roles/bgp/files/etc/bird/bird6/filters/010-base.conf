function f_upstream_export() {
  if is_default() then {
    return "Default route not allowed in fulltable setup";
  }
  if ! is_publicly_routable() then {
    return "Not publicly routable";
  }
  if ! is_own_net() then {
    return "Not our network";
  }
  return "";
}

filter upstream_export
string res;
{
  res = f_upstream_export();
  if res = "" then {
    accept;
  }
  reject res;
}

function f_upstream_import() {
  if is_default() then {
    return "Default route not allowed in fulltable setup";
  }
  if ! is_publicly_routable() then {
    return "Not publicly routable";
  }
  if is_own_net() then {
    return "Part of our network";
  }
  return "";
}

filter upstream_import
string res;
{
  res = f_upstream_import();
  if res = "" then {
    accept;
  }
  reject res;
}

filter ibgp_import {
  accept;
}

filter ibgp_export {
  accept;
}
